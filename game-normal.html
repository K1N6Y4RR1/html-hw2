<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deviner les nombres de biscuits</title>
    <style>
        #body {
            background-image:url(./grandmad1_background.webp);
            background-size:250px 250px;
            background-attachment:fixed;
            background-repeat:repeat;
            text-align:center;
        }
        /* L'image dans le background se répète sans arrêt.*/
        h1 {
            color:rgb(174, 88, 31);
            font-family:"comic sans ms";
            font-size:30px;
            margin:0px;
            margin-top: 0;
            margin-bottom: 0;
            padding-bottom:0px;
            padding-top:25px;
            padding-left:15px;
            padding-right:15px;
        }
        #numbers {
            color:rgb(196, 118, 1);
            font-family:"comic sans ms";
            padding-left:15px;
            padding-right:15px;
            font-size:22px;
            margin:0px;
            padding:0px;
        }
        /* Le nombre de chiffres possibles. Ce nombre change dépendamment de la difficulté choisi dans la page précédente. */
        #vie {
            margin:auto;
            position:fixed;
            bottom : 30px;
            width: 900px;
            height:180px; 
            left:calc(50% - 450px);   
            background-image:url(./big\ cookie.png);
            background-size : 180px 180px;
        }
        /* Les vies. Ils sont représentés par des biscuits. */
        #speech {
            height: 0;
            width: 0;
            color: aliceblue;
            align-self: center;
            border-right:10vw solid;
            border-top: 5vw solid transparent;
            border-bottom: 5vw solid transparent;
            margin-left: 3vw;
        }
        /* Le triangle pour le speech bubble qui relie le jeu à la grand-mère.
        Aide : https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_shapes_triangle-left */
        #comment {
            font-family: "comic sans ms";
            position:absolute;
            bottom:15px;
            width:700px;
            height:50px;
            text-align:center;
            font-size: 30px;
            color: rgb(108, 64, 35);
            margin-top: 20px;
        }
        /* Extra. Petit message que la grand-mère nous donne dépendamment du nombre de vie. */
        #start {
            width:100%;
            height:100%;
            position:absolute;
            background-color: black;
            top:0px;
            left:0px;
            opacity: 85%;
            display: flex;
            align-items: center;
        }
        /* Lorsqu'on commence le jeu, l'écran est noir et nous demande de cliquer afin de commencer le jeu. Je l'ai ajouté afin de pouvoir commencer la musique (qui était supposé de jouer lorsqu'on ouvre la page) peu importe le browser. */
        #button {
            background-color: rgb(149, 90, 51);
            font-family: 'comic sans ms';
            border: 2px solid rgb(108, 64, 35);
            padding:15px 16px 15px 16px;
            text-align: center;
            font-size: 16px;
            margin: 10px 0 10px 0;
            transition-duration: 0.4s;
        }
        #button:hover {
            box-shadow: 5px 5px rgba(252, 167, 8, 0.6);
            color:aliceblue;
        }
        /* Le bouton où le joueur vérifie si sa réponse est la bonne. Il a un effet lorsque la souris est sur celui-ci. (shadow et la couleur du texte) */
        input[id='nombre'] {
            color:rgb(73, 43, 23);
            font-family: 'comic sans ms';
            padding:10px;
            font-size: 20px;
            border: 2px solid rgb(108, 64, 35);
            border-radius: 5px;
            text-align: center;
            transition-duration:0.15s;
        }
        input[id='nombre']:hover {
            box-shadow: 5px 5px rgba(252, 167, 8, 0.6);
        }
        /* L'input où le joueur met sa réponse. Il a un effet lorsque la souris est sur celui-ci. (shadow) */
        input[id='response'] {
            margin:35px;
            pointer-events: none;
            font-family: 'comic sans ms';
            width:500px;
            font-size: 20px;
            padding: 0 5px;
            border: none;
            background-color:aliceblue;
            text-align: center;
            color:rgb(73, 43, 23);
        }
        /* Le input où le jeu dit au joueur si le nombre donné est plus grand, plus petit ou exactement la même que la réponse. */
        /* Il ne peut pas être intéragit par le joueur.*/

        /* Aide pour les inputs : https://www.w3schools.com/css/css_form.asp */
        #again {
            opacity: 0;
            pointer-events: none;
            border: 2px solid rgb(73, 43, 23);
            width:200px;
            margin:auto;
            height:100px;
            background-color: rgb(149, 90, 51);
            font-family: 'comic sans ms';
            padding:15px 16px;
            text-align: center;
            font-size: 30px;
            color:black;
            transition-duration: 0.4s;
            text-decoration:none;
        }
        #again:hover {
            box-shadow: 7px 7px rgba(252, 167, 8);
            color:aliceblue;
        }
        /* Le bouton pour recommencer le jeu (amener à la page pour choisir la diffculté). Il a un effet lorsque la souris est sur le bouton. (shadow et couleur du texte) */
    </style>
</head>
<body id="body">
    <image id="winner" src="" style="position:absolute; top:0px; left:0px; width:100%; height:100%; pointer-events: none;"></image>
    <!--Image (gif) qui joue lorsque le joueur gagne-->
    <audio src="yayying.mp3" id="yay"> </audio>
    <audio src='backgroundmusic.mp3' id='backgroundmusic'> </audio>
    <audio src="assend.mp3" id="assend"> </audio>
    <audio src="secret.mp3" id="secret"> </audio>
    <!-- Les sfx et chansons utilisés dans cette page. -->
    <div style='height:250px; width:250px; margin-left:10vw; float: left; border:5px solid black; display:flex; flex-direction:row;'>
        <image id="grandmas" src="grandma.png" style="height:250px; width:250px;"> </image>
        <div id="speech"> </div>
    </div>
    <!-- L'image de la grand-mère et le triangle pour le speech bubble.-->
    <div style = "position:relative; margin:auto; margin-top:150px; margin-left:35vw; background-color: aliceblue; width:700px; height:400px; text-align:center; border-radius: 45px;">
        <h1> Devinez le nombre de biscuits que j'ai fait </h1> <br>
        <div id="numbers"> </div> <br>
        <input type="text" id="nombre"> <br>
        <input type="button" value="Verification" id="button" onclick="verif()"> <br>
        <input type="text" id="response"> <br>
        <div id="comment"> "Bonne Chance!" - Grandma </div>
    </div>
    <!-- La boîte qui contient tout les éléments du jeu + le message de la grand-mère.-->

    <div id="vie"> </div>
    <!-- Les vies. -->

    <div id='start' onclick="start()">
        <h1 style="font-size: 100px; margin:auto;"> CLIQUEZ POUR COMMENCER </h1>
    </div>
    <!-- L'écran noir opaque lorsque tu ouvres la page et le text qui dit comment commencer le jeu. -->

    <div style="margin:auto; margin-top:15vh;">
        <a id="again" href="difficulty.html"> Réssayer? </a>
    </div>
    <!-- Le bouton pour recommencer le jeu. Il nous retourne aux options de diffculté.-->
    <script>
        var stored = localStorage.getItem("difficulty");
        // La variable qui détermine la quantité de réponses possibles. Le joueur le choisi dans la page difficulty.html.
        var aleatoire = Math.floor(Math.random() * stored);
        // La réponse aléatoire de 0 à "stored" (10 - 100 - 10000). 
        var life = 900;
        var background = document.getElementById('backgroundmusic');
        var yay = document.getElementById('yay');
        var cookie = document.getElementById('assend');
        var secret = document.getElementById('secret');
        // Les audios utilisés.
        
        console.log(aleatoire);
        function start() {
            var start = document.getElementById('start');
            background.loop = true;
            background.play();
            start.style.opacity = 0;
            start.style.pointerEvents = 'none';
            numbers.innerHTML = "(Entre 0-"+stored+")";
        }
        // Lorsqu'on appuie l'écran noir opaque, il disparait et ne peut plus être intéragit par le joueur. La musique commence et le jeu écrit le nombre de chiffres possibles (variable numbers).
        // Aide : https://stackoverflow.com/questions/18083061/make-element-unclickable-click-things-behind-it
        // https://stackoverflow.com/questions/13610638/loop-audio-with-javascript

        function verif() {
            var nombre = parseInt(document.getElementById("nombre").value, 10);
            var vie = document.getElementById("vie");
            var reponse = document.getElementById("response");
            console.log(nombre);
                if (nombre === aleatoire) {
                    reponse.value = "Vous avez gagné!";
                    winner.src = "confetti-holiday-cheer.gif";
                    yay.load();
                    yay.play();
                }
                if (nombre > aleatoire) {
                    cookie.load();
                    cookie.play();
                    reponse.value = "Le nombre est plus petit!";
                    life -= 180;
                    vie.style.left = "calc(50% - " + (life / 2) + "px)";
                    vie.style.width = life + "px";
                }
                if (nombre < aleatoire) {
                    cookie.load();
                    cookie.play();
                    reponse.value = "Le nombre est plus grand";
                    life -= 180;
                    vie.style.left = "calc(50% - " + (life / 2) + "px)";
                    vie.style.width =life+"px";
                }
                if (life <= 0) {
                    secret.load();
                    secret.play();
                    reponse.value = "Game Over! Le nombre était " + aleatoire;

                }
                
                // Le code pour vérifier si le joueur a gagné.

                if (life === 720) {
                    grandmas.src ='grandmad.png'
                    body.style.backgroundRepeat = 'no-repeat';
                    body.style.backgroundSize = '100% 100%';
                    body.style.backgroundImage = 'url(./cookie_backgroundd.jpg)';
                    comment.innerHTML = "Je crois en toi! - Grandma"
                    // Pour ce background, il ne se repète pas et couvre entièrement l'écran.
                }
                if (life === 540) {
                    grandmas.src ='grandmad2.png'
                    body.style.backgroundRepeat = 'repeat';
                    body.style.backgroundSize = '250px 250px';
                    body.style.backgroundImage = 'url(./grandmad2_background.jpg)';
                    comment.innerHTML = "Celui-ci sera la bonne! - Grandma"
                }
                if (life === 360) {
                    grandmas.src ='grandmad3.png'
                    body.style.backgroundImage = 'url(./grandmad3_background.webp)';
                    comment.innerHTML = "Il ne te reste pas beaucoup de chances..."
                }
                if (life === 180) {
                    grandmas.src ='grandmad4.png'
                    body.style.backgroundImage = 'url(./grandmad4_background.png)';
                    comment.innerHTML = ' ...'
                }
                if (life === 0) {
                    comment.innerHTML = ' Je suis déçue par ta performance...'
                    again.style.opacity = 1;
                    again.style.pointerEvents = 'auto';
                }
                // Nouveaux portrait de la grand-mère et du background pour chaque vie que tu perds. Il y a aussi un nouveau message selon le nombre de vie.
        }
    </script>
</body>
</html>